<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Avaliação de Perfil de Comunicação</title>
    <style>
        :root{
            /* Cores extraídas da imagem de referência */
            --brand: #433e7a;            /* Roxo profundo do título principal */
            --brand-600: #5a5496;
            --brand-700: #2d295e;
            --ink: #2d295e;              /* Azul marinho profundo para textos */
            --muted: #7c85a1;            /* Tom acinzentado azulado */
            --bg: #e3f2fd;               /* Azul glacial suave do fundo da imagem */
            --card: #ffffff;
            --line: #d1d9e6;             /* Linhas em azul pálido */
            --ok: #10b981;
            --warn: #f59e0b;
            --info: #8da2fb;             /* Lavanda dos detalhes ilustrativos */
            --success-50: #f0f4ff;
            --shadow: 0 10px 25px rgba(67, 62, 122, 0.12);
            --radius: 14px;
        }

        *{box-sizing:border-box}
        html,body{height:100%}
        body{
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif;
            margin:0; color:var(--ink); background:var(--bg);
        }

        /* ---------- Header ---------- */
        .appbar{
            position:sticky; top:0; z-index:50;
            backdrop-filter:saturate(150%) blur(10px);
            background: color-mix(in oklab, var(--bg) 80%, white);
            border-bottom:1px solid var(--line);
        }
        .appbar-inner{
            max-width:1080px; margin:0 auto; padding:14px 20px; display:flex; gap:16px; align-items:center; justify-content:space-between;
        }
        .brand{
            display:flex; align-items:center; gap:12px; font-weight:800; letter-spacing:.2px;
            color:var(--brand-700);
        }
        .brand .dot{width:12px; height:12px; border-radius:50%; background:var(--info)}
        .app-actions{display:flex; gap:10px}
        .btn{
            appearance:none; border:1px solid var(--line); background:var(--card); color:var(--ink);
            padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:600; transition:.2s ease; box-shadow:0 1px 0 rgba(0,0,0,.02);
        }
        .btn.primary{background:var(--brand); color:#fff; border-color:var(--brand-700);}
        .btn.primary:hover{background:var(--brand-600)}
        .btn.ghost{background:transparent; border-color: transparent; color: var(--brand)}

        /* ---------- Container / Sections ---------- */
        .shell{max-width:1080px; margin:24px auto; padding:0 20px}

        .card{background:var(--card); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow)}
        .card-header{padding:20px 22px; border-bottom:1px solid var(--line); display:flex; align-items:center; justify-content:space-between}
        .card-title{margin:0; font-size:20px; color: var(--brand-700)}
        .badge{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; font-size:12px; background:#f0f4ff; color:var(--brand); border:1px solid #c7d2fe}

        .content{padding:22px}

        /* ---------- Intro / Inputs ---------- */
        .intro{display:grid; gap:14px; grid-template-columns:1fr; margin-bottom:14px}
        .field-grid{display:grid; gap:12px; grid-template-columns:repeat(2, minmax(0,1fr));}
        .field{display:grid; gap:6px}
        .label{font-size:12px; color:var(--muted); font-weight:700; letter-spacing:.2px}
        .input{
            padding:12px 12px; border-radius:10px; border:1px solid var(--line); outline:none; background:#fff;
            font-size:16px; line-height:1.2; transition:border-color .15s, box-shadow .15s;
        }
        .input:focus{border-color:var(--brand); box-shadow:0 0 0 3px color-mix(in oklab, var(--brand) 20%, transparent)}

        .notice{
            border-left:4px solid var(--info); background:#f8faff; padding:12px 14px; border-radius:10px; font-size:14px; color:var(--ink);
        }

        /* ---------- Questions ---------- */
        .qgroup{border:1px solid var(--line); border-radius:12px; padding:16px; background:#fff; box-shadow:0 2px 10px rgba(0,0,0,.03)}
        .qgroup + .qgroup{margin-top:12px}
        .qtitle{margin:0 0 12px 0; font-size:16px; color: var(--brand-700)}
        .options{display:grid; gap:12px; grid-template-columns:repeat(4, minmax(0,1fr))}
        @media (max-width:980px){ .options{grid-template-columns:repeat(2, minmax(0,1fr))} }
        @media (max-width:560px){ .options{grid-template-columns:1fr} }

        .opt{display:grid; align-content:start; gap:10px; border:1px dashed var(--line); border-radius:10px; padding:12px; background:linear-gradient(180deg,#fff, #fcfdff)}
        .opttxt{font-size:14px; color:var(--ink); min-height:40px; display:flex; align-items:center}

        .select{appearance:none; width:100%; padding:10px 12px; border:1px solid var(--line); border-radius:10px; font-weight:700; text-align:center; cursor:pointer; background: #fff url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M5 7l5 5 5-5" stroke="%23433e7a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>') no-repeat right 10px center}
        .select:focus{border-color:var(--brand); outline:none; box-shadow:0 0 0 3px color-mix(in oklab, var(--brand) 20%, transparent)}

        .error{margin-top:10px; font-size:13px; color:var(--brand); font-weight:800; display:none}
        .qgroup.invalid .error{display:block}
        .qgroup.invalid{border-color:var(--info); box-shadow:0 0 0 3px color-mix(in oklab, var(--info) 20%, transparent)}

        .actions{display:flex; justify-content:center; gap:12px; margin-top:16px}

        /* ---------- Results & Podium ---------- */
        .results{display:none}
        .results.show{display:block}

        .kpis{display:grid; grid-template-columns:repeat(4, minmax(0,1fr)); gap:12px}
        @media (max-width:800px){ .kpis{grid-template-columns:repeat(2, minmax(0,1fr))} }
        @media (max-width:500px){ .kpis{grid-template-columns:1fr} }
        .kpi{background:#ffffff; border:1px solid var(--line); border-radius:12px; padding:14px; text-align:center; box-shadow:var(--shadow)}
        .kpi .label{color:var(--muted); font-weight:700}
        .kpi .big{font-size:28px; font-weight:900; margin-top:4px; color: var(--brand)}

        .podium{display:flex; align-items:flex-end; justify-content:center; gap:12px; height:320px; margin:24px 0 10px}
        .step{width:180px; border-radius:12px 12px 0 0; position:relative; overflow:hidden; border:1px solid var(--line); background:linear-gradient(180deg, #fff, #f0f4ff)}
        .step .label{position:absolute; bottom:0; left:0; right:0; padding:10px; font-weight:900; text-align:center; color:#fff}
        .step .rank{position:absolute; top:-42px; left:50%; transform:translateX(-50%); font-weight:900; background:var(--brand-700); color:#fff; padding:6px 10px; border-radius:999px; font-size:12px; letter-spacing:.2px}

        .g1{background:linear-gradient(180deg, #dce4ff, #8da2fb)}
        .g1 .label{background:var(--brand)}
        .g2{background:linear-gradient(180deg, #f7f7f7, #cbd5e1)}
        .g2 .label{background:#64748b}
        .g3{background:linear-gradient(180deg, #fff5f5, #e2e8f0)}
        .g3 .label{background:#94a3b8}
        .g4{background:linear-gradient(180deg, #f8fafc, #f1f5f9)}
        .g4 .label{background:#cbd5e1}

        .desc{margin-top:18px; border-top:2px solid var(--info); padding-top:14px}
        .pdesc{border-left:6px solid; background:#fff; border-radius:10px; box-shadow:var(--shadow); padding:14px; margin-bottom:14px}
        .pdesc h4{margin:0 0 6px 0; color: var(--brand-700)}

        .A{border-color:var(--brand)}
        .B{border-color:var(--info)}
        .C{border-color:#5a5496}
        .D{border-color:#a5b4fc}
        
        .report-header{
            color: var(--brand);
            text-align: center;
            border-bottom: 2px solid var(--info);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

    </style>
</head>
<body>
    <header class="appbar" role="banner">
        <div class="appbar-inner">
            <div class="brand"><span class="dot" aria-hidden="true"></span> ESTILOS DE COMUNICAÇÃO</div>
            <div class="app-actions">
                <button id="jumpToForm" class="btn ghost" type="button">Ir para formulário</button>
                <button id="jumpToResults" class="btn ghost" type="button">Ir para resultados</button>
                <button id="exportTop" class="btn primary" type="button">Exportar HTML</button>
            </div>
        </div>
    </header>

    <main class="shell">
        <section class="card" id="introCard">
            <div class="card-header">
                <h1 class="card-title">Avaliação de Perfil de Comunicação</h1>
                <span class="badge" title="Use 4, 3, 2 e 1, uma vez por pergunta">Regra dos 4 números</span>
            </div>
            <div class="content">
                <div class="intro">
                    <div class="notice">
                        <strong>Como funciona:</strong> Para cada questão, use os números <strong>4, 3, 2 e 1</strong> <u>uma única vez</u> nos quatro itens. 4 = mais representativo; 1 = menos.
                    </div>
                    <div class="field-grid">
                        <label class="field">
                            <span class="label">Nome completo</span>
                            <input id="userName" class="input" type="text" placeholder="Ex.: Maria de Souza" required />
                        </label>
                        <label class="field">
                            <span class="label">Setor / Departamento</span>
                            <input id="userSector" class="input" type="text" placeholder="Ex.: Comercial" required />
                        </label>
                    </div>
                </div>
                <div id="infoHeader" style="display:none; border:1px solid var(--line); border-radius:12px; background:#fff; padding:12px; grid-template-columns:repeat(4, minmax(0,1fr)); gap:12px;">
                    <div><strong>Nome:</strong> <span id="displayUserName"></span></div>
                    <div><strong>Setor:</strong> <span id="displayUserSector"></span></div>
                    <div><strong>Data:</strong> <span id="displayDate"></span></div>
                    <div><strong>Hora:</strong> <span id="displayTime"></span></div>
                </div>
            </div>
        </section>

        <form id="communicationForm" class="card" style="margin-top:16px">
            <div class="card-header"><h2 class="card-title">Responda às questões</h2></div>
            <div class="content" id="questions"></div>
            <div class="actions">
                <button class="btn" type="reset" id="resetBtn">Limpar</button>
                <button class="btn primary" type="submit">Revelar meu perfil</button>
            </div>
        </form>

        <section id="resultsSection" class="card results" aria-live="polite" style="margin-top:16px">
            <div class="card-header"><h2 class="card-title">Seu resultado</h2><span class="badge">Resumo</span></div>
            <div class="content">
                <div class="kpis" id="kpis"></div>
                <div class="podium" id="podium" role="img" aria-label="Pódio por perfis"></div>
                <div class="actions"><button id="exportHtmlButton" class="btn primary" type="button">Exportar relatório em HTML</button></div>
                
                <div class="desc" id="descriptionBox">
                    <h3 style="margin:0 0 12px 0; color:var(--brand)">Detalhes dos estilos</h3>

                    <article class="pdesc A pdf-block" data-profile="A" id="desc-A">
                        <h4>A — Imaginativo (Conceitual)</h4>
                        <h5>Estilo de comunicação</h5>
                        <ul>
                            <li>Têm uma mente <strong>questionadora</strong> e <strong>imaginativa</strong> para solucionar desafios.</li>
                            <li>São comprometidos com projetos de <strong>longo prazo</strong>.</li>
                            <li>Quando líderes, assumem responsabilidades e riscos pessoais.</li>
                        </ul>
                        <h5>Como se comunicar?</h5>
                        <ul>
                            <li>Enfatize <strong>pontos inovadores</strong> e fale sobre implicações de <strong>longo prazo</strong>.</li>
                            <li>Evite excesso de detalhes, não seja pessoal e não deprecie ideias.</li>
                        </ul>
                    </article>

                    <article class="pdesc B pdf-block" data-profile="B" id="desc-B">
                        <h4>B — Analítico (Metódico)</h4>
                        <h5>Estilo de comunicação</h5>
                        <ul>
                            <li>Tendem a ser <strong>mais formais</strong> ao se comunicar.</li>
                            <li>São bons estudando <strong>dados</strong> e calculando <strong>riscos</strong>.</li>
                            <li>Em reuniões, são <strong>sistemáticos</strong>.</li>
                            <li>Podem parecer <strong>frios</strong>, <strong>controladores</strong> e <strong>rígidos</strong>.</li>
                        </ul>
                        <h5>Como se comunicar?</h5>
                        <ul>
                            <li>Seja <strong>formal e detalhista</strong> e siga uma <strong>sequência lógica</strong>.</li>
                            <li>Evite <strong>generalizações</strong> e apelos <strong>emocionais</strong>.</li>
                        </ul>
                    </article>

                    <article class="pdesc C pdf-block" data-profile="C" id="desc-C">
                        <h4>C — Pragmático (Realizador)</h4>
                        <h5>Estilo de comunicação</h5>
                        <ul>
                            <li>Prioriza <strong>resultados</strong> e se comunica de forma <strong>direta</strong>.</li>
                            <li>Lida bem com projetos de <strong>curto prazo</strong>.</li>
                            <li>Toma decisões rápido; sob pressão pode <strong>atropelar</strong> os outros.</li>
                        </ul>
                        <h5>Como se comunicar?</h5>
                        <ul>
                            <li>Destaque <strong>resultados</strong>, foque em <strong>praticidade</strong> e seja <strong>breve</strong>.</li>
                            <li>Evite abstrações e rodeios.</li>
                        </ul>
                    </article>

                    <article class="pdesc D pdf-block" data-profile="D" id="desc-D">
                        <h4>D — Social (Afetivo)</h4>
                        <h5>Estilo de comunicação</h5>
                        <ul>
                            <li>Valoriza <strong>relacionamentos</strong> e a dimensão <strong>humana</strong>.</li>
                            <li>Costuma ser <strong>persuasivo</strong>, <strong>paciente</strong> e bom comunicador.</li>
                            <li>Estimula o <strong>trabalho em equipe</strong>.</li>
                        </ul>
                        <h5>Como se comunicar?</h5>
                        <ul>
                            <li>Mantenha proximidade e use argumentos com <strong>impacto humano</strong>.</li>
                            <li>Evite ser <strong>frio</strong> e <strong>impessoal</strong>.</li>
                        </ul>
                    </article>
                </div>
            </div>
        </section>
    </main>

    <script>
        const PROFILES = {
            A: { name: "Imaginativo (Conceitual)", color: "#433e7a" },
            B: { name: "Analítico (Metódico)", color: "#8da2fb" },
            C: { name: "Pragmático (Realizador)", color: "#5a5496" },
            D: { name: "Social (Afetivo)", color: "#a5b4fc" }
        };
        const scoreValues = [4,3,2,1];

        const questionsData = [
            { id:1, t:"1. Aprendo melhor:", A:"Pela reflexão", B:"Por demonstrações", C:"Praticando", D:"Pela intuição" },
            { id:2, t:"2. Produzo melhor:", A:"Criando", B:"Programando", C:"Executando", D:"Em grupo" },
            { id:3, t:"3. Gosto de treinamentos:", A:"Mais conceituais", B:"Mais metódico", C:"Mais práticos", D:"Mais vivenciais" },
            { id:4, t:"4. Trabalho melhor em grupo no papel de:", A:"Sintetizador", B:"Organizador", C:"Realizador", D:"Apoiador" },
            { id:5, t:"5. Diante de situações novas, tendo primeiro a ser:", A:"Visualizar e compreender", B:"Buscar estruturar", C:"Fazer o necessário", D:"Envolver as pessoas" },
            { id:6, t:"6. Quando converso com uma pessoa, sou mais:", A:"Pensativa", B:"Disciplinada", C:"Eficiente", D:"Sensível" },
            { id:7, t:"7. Identifico-me mais com pessoas:", A:"Estrategistas", B:"Racionais", C:"Dinâmicas", D:"Afetivas" },
            { id:8, t:"8. Sou geralmente mais habilidoso para:", A:"Idealizar", B:"Esquematizar", C:"Executar", D:"Influenciar" },
            { id:9, t:"9. Dizem que sou uma pessoa:", A:"Visionária", B:"Lógica", C:"Empreendedora", D:"Sensível" },
            { id:10,t:"10. O verbo que mais me representa:", A:"Conceituar", B:"Analisar", C:"Fazer", D:"Sentir" },
            { id:11,t:"11. Uso a minha cabeça para:", A:"Compreender os porquês", B:"Observar e analisar", C:"Colocar ideias em prática", D:"Pensar nos outros" },
            { id:12,t:"12. Quando sou apresentado a alguém, tendo a:", A:"Imaginar que tipo de pessoa é", B:"Avaliar antes de interagir", C:"Interagir imediatamente", D:"Olhar e sorrir" },
            { id:13,t:"13. Um ponto em que me destaco é a:", A:"Inovação", B:"Consistência", C:"Pró-atividade", D:"Sociabilidade" },
            { id:14,t:"14. Sinto-me motivado em trabalhos que requeiram:", A:"Visão de futuro", B:"Organização e método", C:"Atividade", D:"Interação com pessoas" },
            { id:15,t:"15. Tomo melhores decisões quando:", A:"Vejo o todo e entendo os conceitos", B:"Baseio-me em fatos e dados", C:"Ajo rapidamente", D:"Penso junto com outras pessoas" }
        ];

        const qsContainer = document.getElementById('questions');
        const form = document.getElementById('communicationForm');
        const resultsSection = document.getElementById('resultsSection');
        const kpisEl = document.getElementById('kpis');
        const podiumEl = document.getElementById('podium');
        const exportBtnHtml = document.getElementById('exportHtmlButton');
        const exportBtnTop = document.getElementById('exportTop');
        const infoHeader = document.getElementById('infoHeader');
        const styleTag = document.querySelector('style');

        function buildQuestions(){
            qsContainer.innerHTML = '';
            questionsData.forEach(q => {
                const wrap = document.createElement('div');
                wrap.className = 'qgroup';
                wrap.dataset.questionId = q.id;
                wrap.innerHTML = `
                    <h3 class="qtitle">${q.t}</h3>
                    <div class="options">
                        ${['A','B','C','D'].map(k => `
                            <div class="opt">
                                <div class="opttxt">${q[k]}</div>
                                <select class="select" data-style="${k}" name="q${q.id}_${k}" required></select>
                            </div>
                        `).join('')}
                    </div>
                    <div class="error">Use 4, 3, 2 e 1 exatamente uma vez.</div>
                `;
                qsContainer.appendChild(wrap);
            });

            const selects = document.querySelectorAll('.select');
            initializeSelects(selects);
            selects.forEach(s => s.addEventListener('change', function(){ updateSelectOptions(this); }));
        }

        function initializeSelects(nodeList){
            nodeList.forEach(select=>{
                select.innerHTML = '<option value="">-</option>' + scoreValues.map(v=>`<option value="${v}">${v}</option>`).join('');
            })
        }

        function updateSelectOptions(currentSelect){
            const group = currentSelect.closest('.qgroup');
            const selects = group.querySelectorAll('.select');
            const taken = new Set();
            selects.forEach(s=>{ if(s.value) taken.add(+s.value) });

            selects.forEach(s=>{
                const cur = s.value;
                const opts = ['<option value="">-</option>'];
                scoreValues.forEach(v=>{
                    const disabled = taken.has(v) && +cur!==v;
                    opts.push(`<option ${disabled? 'disabled': ''} value="${v}">${v}</option>`)
                });
                s.innerHTML = opts.join('');
                if(cur) s.value = cur;
            })

            const picked = Array.from(selects).map(s=>+s.value).filter(Boolean);
            const unique = new Set(picked);
            if(picked.length===4 && unique.size!==4){
                group.classList.add('invalid');
            } else {
                group.classList.remove('invalid');
            }
        }

        function updateInfoHeader(name, sector){
            const now = new Date();
            const dateString = now.toLocaleDateString('pt-BR');
            const timeString = now.toLocaleTimeString('pt-BR');
            document.getElementById('displayUserName').textContent = name;
            document.getElementById('displayUserSector').textContent = sector;
            document.getElementById('displayDate').textContent = dateString;
            document.getElementById('displayTime').textContent = timeString;
            document.getElementById('infoHeader').style.display = 'grid';
        }

        function calculateScores(){
            const scores = {A:0,B:0,C:0,D:0};
            document.querySelectorAll('.select').forEach(sel=>{
                const v = parseInt(sel.value); if(!isNaN(v)) scores[sel.dataset.style]+=v;
            })
            const list = Object.keys(scores).map(id=>({ id, name: PROFILES[id].name, score:scores[id] }))
                                .sort((a,b)=> b.score - a.score)
                                .map((p,i)=> ({...p, rank: i+1}));
            return list;
        }

        function renderKPIs(sorted){
            kpisEl.innerHTML = '';
            sorted.forEach(p=>{
                const el = document.createElement('div');
                el.className = 'kpi';
                el.innerHTML = `<div class="label">${p.name} (${p.id})</div><div class="big">${p.score}</div>`;
                kpisEl.appendChild(el);
            })
        }

        function renderPodium(sorted){
            podiumEl.innerHTML='';
            const max = Math.max(...sorted.map(p=>p.score)) || 1;
            const byRank = [
                sorted.find(p=>p.rank===2),
                sorted.find(p=>p.rank===1),
                sorted.find(p=>p.rank===3),
                sorted.find(p=>p.rank===4)
            ].filter(Boolean);

            byRank.forEach(p=>{
                const h = Math.max(80, Math.round(260 * (p.score/max)));
                const div = document.createElement('div');
                div.className = `step g${p.rank}`;
                div.style.height = h + 'px';
                div.innerHTML = `<div class="rank">${p.rank}º</div><div class="label">${p.name.split(' ')[0]} (${p.id})<br>Total: ${p.score}</div>`;
                podiumEl.appendChild(div);
            })
        }

        function showResults(){
            const name = document.getElementById('userName').value.trim();
            const sector = document.getElementById('userSector').value.trim();
            if(!name || !sector){ alert('Preencha Nome e Setor.'); return false; }

            const allGroups = Array.from(document.querySelectorAll('.qgroup'));
            let isValid = true;
            for(const g of allGroups){
                const vals = Array.from(g.querySelectorAll('.select')).map(s=>+s.value);
                const set = new Set(vals);
                if(vals.some(isNaN) || set.size!==4 || ![1,2,3,4].every(v=>set.has(v))){
                    g.classList.add('invalid');
                    if(isValid){ g.scrollIntoView({behavior:'smooth', block:'center'}); }
                    isValid = false;
                } else {
                    g.classList.remove('invalid');
                }
            }

            if(!isValid) return false;

            updateInfoHeader(name, sector);
            const sorted = calculateScores();
            renderKPIs(sorted);
            renderPodium(sorted);

            resultsSection.classList.add('show');
            document.getElementById('resultsSection').scrollIntoView({behavior:'smooth'});
            return sorted;
        }

        form.addEventListener('submit', e=>{
            e.preventDefault();
            showResults();
        })

        document.getElementById('resetBtn').addEventListener('click', ()=>{
            buildQuestions();
            resultsSection.classList.remove('show');
            document.getElementById('infoHeader').style.display = 'none';
        })

        document.getElementById('jumpToForm').onclick = ()=> form.scrollIntoView({behavior:'smooth'});
        document.getElementById('jumpToResults').onclick = ()=> resultsSection.scrollIntoView({behavior:'smooth'});

        buildQuestions();

        function exportHTML(){
            const sorted = showResults();
            if(!sorted) return;

            const userName = document.getElementById('userName').value.trim().replace(/\s/g,'_');
            const userSector = document.getElementById('userSector').value.trim().replace(/\s/g,'_');
            const fileName = `Relatorio_Perfil_${userName}_${userSector}.html`;

            const infoHeaderClone = infoHeader.cloneNode(true);
            infoHeaderClone.style.display = 'grid'; 

            const resultsCardClone = resultsSection.cloneNode(true);
            const actionsDiv = resultsCardClone.querySelector('.actions');
            if(actionsDiv) actionsDiv.remove();

            const reportHTML = `
                <!DOCTYPE html>
                <html lang="pt-BR">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>Relatório de Perfil de Comunicação - ${userName}</title>
                    <style>
                        ${styleTag.innerHTML}
                        .appbar, .actions { display: none !important; }
                        .shell { max-width: 900px; margin: 20px auto; padding: 0 20px; }
                    </style>
                </head>
                <body style="background: var(--bg); padding: 20px;">
                    <main class="shell">
                        <h1 class="report-header">Relatório de Estilos de Comunicação</h1>
                        <section class="card">
                            <div class="content">
                                ${infoHeaderClone.outerHTML}
                            </div>
                        </section>
                        ${resultsCardClone.outerHTML}
                    </main>
                </body>
                </html>
            `;

            const blob = new Blob([reportHTML], { type: 'text/html;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(link.href);
        }

        exportBtnHtml.addEventListener('click', exportHTML);
        exportBtnTop.addEventListener('click', exportHTML);

    </script>
</body>
</html>